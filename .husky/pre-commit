#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Run ESLint
echo "ğŸ” Running ESLint..."
npm run lint

# Run Prettier check
echo "ğŸ’… Checking Prettier formatting..."
npm run format:check

# Run TypeScript type checking
echo "ğŸ”· Running TypeScript type check..."
npm run type-check

# Run SwiftLint if available (optional for iOS development)
if command -v swiftlint >/dev/null 2>&1; then
  echo "ğŸ¦ Running SwiftLint..."
  npm run lint:swift
else
  echo "âš ï¸  SwiftLint not installed, skipping Swift code linting"
fi

# Check test coverage (quick check, not full run)
echo "ğŸ“Š Checking test coverage threshold..."
if npm run test:coverage --silent 2>/dev/null | grep -q "All files.*80%"; then
  echo "âœ… Test coverage meets 80% threshold"
else
  echo "âš ï¸  Test coverage below 80% threshold - consider adding more tests"
fi

echo "All pre-commit checks passed! âœ…"